
<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js"></script>
</head>
<body>
<h2>Dashboard</h2>

<canvas id="genderChart"></canvas>
<canvas id="roomChart"></canvas>

<table border="1" width="100%" id="table"></table>

<script>
getData().then(data=>{
let male=0,female=0;
let rooms={};

let table="<tr><th>ชื่อ</th><th>เลขที่</th><th>ลบ</th></tr>";

data.forEach(d=>{
if(d.gender=="ชาย") male++;
if(d.gender=="หญิง") female++;
rooms[d.room]=(rooms[d.room]||0)+1;

table+=`<tr>
<td>${d.name}</td>
<td>${d.number}</td>
<td><button onclick="remove(${d.row})">ลบ</button></td>
</tr>`;
});

document.getElementById("table").innerHTML=table;

new Chart(genderChart,{
type:"pie",
data:{labels:["ชาย","หญิง"],
datasets:[{data:[male,female]}]}
});

new Chart(roomChart,{
type:"bar",
data:{labels:Object.keys(rooms),
datasets:[{data:Object.values(rooms)}]}
});
});

function remove(row){
if(confirm("ลบข้อมูล?")){
deleteData(row).then(()=>location.reload());
}
}
</script>
</body>
</html>
