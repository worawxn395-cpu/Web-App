<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>แบบประเมิน</title>
</head>
<body>

<nav>
<a href="index.html">แบบประเมิน</a> |
<a href="dashboard.html">Dashboard</a> |
<a href="edit.html">แก้ไข</a>
</nav>
<hr>

<h2>แบบประเมินความพึงพอใจ</h2>

<form id="form">
<div id="questions"></div>
<br>
<button type="submit">ส่งแบบประเมิน</button>
</form>

<script src="script.js"></script>
<script>
let questionData=[];

async function load(){
  questionData = await getQuestions();
  const div = document.getElementById("questions");
  div.innerHTML="";

  questionData.forEach((q,i)=>{
    div.innerHTML+=`
      <div>
        <h3>${i+1}. ${q[0]} ${q[1]}</h3>
        <select required>
          <option value="">เลือกคะแนน</option>
          <option value="5">5</option>
          <option value="4">4</option>
          <option value="3">3</option>
          <option value="2">2</option>
          <option value="1">1</option>
        </select>
      </div>
      <br>
    `;
  });
}

document.getElementById("form").addEventListener("submit",async function(e){
  e.preventDefault();
  const values=[...document.querySelectorAll("select")].map(s=>s.value);
  await saveResponse(values);
  alert("ส่งเรียบร้อย");
  this.reset();
});

load();
</script>

</body>
</html>
