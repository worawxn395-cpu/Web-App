<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js"></script>
</head>

<body class="bg-blue-50">

<!-- NAV -->
<div class="bg-blue-600 text-white p-4 flex justify-center gap-6 font-semibold">
<a href="index.html">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</a>
<a href="dashboard.html">Dashboard</a>
<a href="edit.html">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
</div>

<div class="max-w-2xl mx-auto bg-white p-6 mt-6 rounded-xl shadow">

<h1 class="text-2xl font-bold text-center mb-6 text-blue-700">
‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
</h1>

<input id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠" class="w-full border p-2 mb-3 rounded">
<input id="number" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà" class="w-full border p-2 mb-3 rounded">

<select id="gender" class="w-full border p-2 mb-3 rounded">
<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</option>
<option>‡∏ä‡∏≤‡∏¢</option>
<option>‡∏´‡∏ç‡∏¥‡∏á</option>
</select>

<input id="room" placeholder="‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="w-full border p-2 mb-5 rounded">

<div id="questions"></div>

<textarea id="comment" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"
class="w-full border p-2 mt-4 rounded"></textarea>

<button onclick="submitForm()" 
class="bg-blue-600 hover:bg-blue-700 text-white w-full py-2 mt-4 rounded-lg">
‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
</button>

</div>

<script>
const emojis = ["üò°","üòü","üòê","üòä","üòç"];

function loadQuestions(){
getQuestions().then(data=>{
let box=document.getElementById("questions");
box.innerHTML="";

data.forEach((row,i)=>{
let q=row[0];

let div=document.createElement("div");
div.className="mb-6";

div.innerHTML=`
<p class="font-semibold mb-2">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${i+1} : ${q}</p>
<div class="flex justify-between text-3xl gap-2" id="q${i}"></div>
`;

box.appendChild(div);

let emojiBox=document.getElementById("q"+i);

emojis.forEach((e,index)=>{
let btn=document.createElement("button");
btn.innerHTML=e;
btn.className="flex-1 p-2 rounded-xl hover:bg-blue-100 transition";
btn.onclick=()=>{
[...emojiBox.children].forEach(b=>b.classList.remove("bg-blue-200","scale-110"));
btn.classList.add("bg-blue-200","scale-110");
btn.dataset.value=index+1;
};
emojiBox.appendChild(btn);
});
});
});
}

function submitForm(){

let answers=[];
document.querySelectorAll("[id^=q]").forEach(q=>{
let selected=[...q.children].find(b=>b.dataset.value);
answers.push(selected?selected.dataset.value:0);
});

if(answers.includes(0)){
alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠");
return;
}

let data=[
name.value,
number.value,
gender.value,
room.value,
...answers,
comment.value
];

saveResponse(data).then(()=>{
alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
location.reload();
});
}

loadQuestions();
</script>

</body>
</html>
